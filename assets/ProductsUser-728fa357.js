import{P as w}from"./PageComponent-1af22c40.js";import{S as v}from"./SubScribe-6fcad765.js";import{_ as L,r as g,o as r,c,b as _,a as t,F as h,e as b,t as l,d as m}from"./index-9ef7758a.js";const k={data(){return{products:{},nowProducts:{},id:"",brand:["CHANEL","Jo Malone","Curology","Dior","Chloe","ZARA","TONIK"],isLoading:!1,btnLoading:!1,cartNum:0,pageData:{},wishList:[],wishList2:{}}},inject:["emitter"],components:{Subscribe:v,Page:w},methods:{getProducts(e){this.isLoading=!0;const a="https://vue3-course-api.hexschool.io/api/roger8426-api/products/all";this.$http.get(a).then(n=>{if(n.data.success){const i=Math.ceil(n.data.products.length/12);this.pageData={perPage:12,current_page:1,total_pages:i,has_next:i>1},e?(this.products=n.data.products.filter(o=>o.category===e),this.pageData.total_pages=Math.ceil(this.products.length/12)):this.products=n.data.products,this.nowProducts=this.products.filter((o,p)=>{if(p>=0&&p<12)return o})}this.isLoading=!1})},nowPage(e){this.pageData.current_page=e,this.pageData.has_next=this.pageData.total_pages>this.pageData.current_page,this.pageData.has_pre=this.pageData.current_page>1;const a=e*this.pageData.perPage-this.pageData.perPage+1,n=e*this.pageData.perPage;this.nowProducts=this.products.filter((u,i)=>{const o=i+1;if(o>=a&&o<=n)return u})},getProduct(e){this.$router.push(`/user/product/${e}`)},addCart(e){const a="https://vue3-course-api.hexschool.io/api/roger8426-api/cart",n={product_id:e,qty:1};this.btnLoading=!0,this.$http.post(a,{data:n}).then(u=>{u.data.success&&this.$http.get(a).then(i=>{this.cartNum=i.data.data.carts.length,this.emitter.emit("cart-num",this.cartNum),this.btnLoading=!1})})},addWish(e){this.wishList.find(n=>n.id===e.id)?alert("已在願望清單中"):this.wishList.push(e),this.emitter.emit("emit-wish-from-nav",this.wishList)}},created(){this.getProducts()}},C={class:"bg-primary"},x={class:"container px-0"},D={class:"col"},$={class:"d-flex mb-0 ps-0 d-sm-none d-md-flex"},N=["onClick"],B={class:"dropdown d-sm-block d-md-none"},S=t("button",{class:"btn btn-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Brand Select ",-1),A={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},M=["onClick"],V={class:"container productsList mt-md-7 mt-sm-4 mb-6"},E={class:"row"},T=["onClick"],F=["src"],U={class:"fs-3 fw-bold mb-0"},W={class:"mb-0"},j={class:"d-flex"},q={class:"mb-0 me-2"},H={key:0,class:"mb-0 text-info text-decoration-line-through"},I={class:"d-flex mt-1"},J={key:0,class:"btn-group d-flex",role:"group","aria-label":"Basic example"},K=["onClick"],O=t("i",{class:"bi bi-heart-fill me-1"},null,-1),R=[O],Z=["onClick"],z=t("i",{class:"bi bi-cart2 me-1"},null,-1),G=[z],Q={key:1,class:"spinner-border spinner-border-sm text-primary mt-1 ms-1",role:"status"},X=t("span",{class:"visually-hidden"},"Loading...",-1),Y=[X];function tt(e,a,n,u,i,o){const p=g("LoadingView"),f=g("Page"),P=g("Subscribe");return r(),c(h,null,[_(p,{active:i.isLoading},null,8,["active"]),t("div",C,[t("div",x,[t("div",D,[t("ul",$,[(r(!0),c(h,null,b(i.brand,(s,d)=>(r(),c("li",{key:d},[t("button",{type:"button",class:"btn btn-primary",onClick:y=>o.getProducts(s)},l(s),9,N)]))),128)),t("li",null,[t("button",{type:"button",class:"btn btn-primary",onClick:a[0]||(a[0]=s=>o.getProducts(e.item))},"ALL")])]),t("div",B,[S,t("ul",A,[(r(!0),c(h,null,b(i.brand,(s,d)=>(r(),c("li",{key:d},[t("button",{class:"dropdown-item",type:"button",onClick:y=>o.getProducts(s)},l(s),9,M)]))),128)),t("li",null,[t("button",{type:"button",class:"dropdown-item",onClick:a[1]||(a[1]=s=>o.getProducts(e.item))},"ALL")])])])])])]),t("div",V,[t("div",E,[(r(!0),c(h,null,b(i.nowProducts,s=>(r(),c("div",{class:"col-lg-3 col-sm-6 mb-6",key:s.id},[t("button",{type:"button",class:"w-100 p-0 border-0 mb-1",onClick:d=>o.getProduct(s.id)},[t("img",{src:s.imageUrl,class:"w-100",alt:"product"},null,8,F)],8,T),t("h4",U,l(s.title),1),t("p",W,l(s.category),1),t("div",j,[t("p",q,l(`NT$${e.$filters.currency(s.price)}`),1),s.origin_price>s.price?(r(),c("p",H,l(`NT$${e.$filters.currency(s.origin_price)}`),1)):m("",!0)]),t("div",I,[this.btnLoading?m("",!0):(r(),c("div",J,[t("button",{type:"button",class:"btn text-primary p-0 me-2",onClick:d=>o.addWish(s)},R,8,K),t("button",{type:"button",class:"btn text-primary p-0 ms-1",onClick:d=>o.addCart(s.id)},G,8,Z)])),this.btnLoading?(r(),c("div",Q,Y)):m("",!0)])]))),128))])]),_(f,{pages:i.pageData,onEmitPage:o.nowPage},null,8,["pages","onEmitPage"]),_(P)],64)}const at=L(k,[["render",tt]]);export{at as default};
