import{P as w}from"./PageComponent-f3c33876.js";import{S as L}from"./SubScribe-96bed7a0.js";import{_ as v,r as g,o as n,c as r,b as _,a as t,F as h,e as b,t as l,d as m}from"./index-d05cdc81.js";const k={data(){return{products:{},nowProducts:{},id:"",brand:["CHANEL","Jo Malone","Curology","Dior","Chloe","ZARA","TONIK"],isLoading:!1,btnLoading:!1,cartNum:0,pageData:{},wishList:[]}},inject:["emitter"],components:{Subscribe:L,Page:w},methods:{getProducts(s){this.isLoading=!0;const a="https://vue3-course-api.hexschool.io/api/roger8426-api/products/all";this.$http.get(a).then(c=>{if(c.data.success){const i=Math.ceil(c.data.products.length/12);this.pageData={perPage:12,current_page:1,total_pages:i,has_next:i>1},s?(this.products=c.data.products.filter(o=>o.category===s),this.pageData.total_pages=Math.ceil(this.products.length/12)):this.products=c.data.products,this.nowProducts=this.products.filter((o,p)=>{if(p>=0&&p<12)return o})}this.isLoading=!1})},nowPage(s){this.pageData.current_page=s,this.pageData.has_next=this.pageData.total_pages>this.pageData.current_page,this.pageData.has_pre=this.pageData.current_page>1;const a=s*this.pageData.perPage-this.pageData.perPage+1,c=s*this.pageData.perPage;this.nowProducts=this.products.filter((u,i)=>{const o=i+1;if(o>=a&&o<=c)return u})},getProduct(s){this.$router.push(`/user/product/${s}`)},addCart(s){const a="https://vue3-course-api.hexschool.io/api/roger8426-api/cart",c={product_id:s,qty:1};this.btnLoading=!0,this.$http.post(a,{data:c}).then(u=>{u.data.success&&this.$http.get(a).then(i=>{this.cartNum=i.data.data.carts.length,this.emitter.emit("cart-num",this.cartNum),this.btnLoading=!1})})},addWish(s){this.wishList[0]?this.wishList.forEach(a=>{a.id!==s.id?this.wishList.push(s):alert("已在願望清單中")}):this.wishList.push(s),this.emitter.emit("wishList",this.wishList)}},created(){this.getProducts()}},C={class:"bg-primary"},x={class:"container px-0"},D={class:"col"},$={class:"d-flex mb-0 ps-0 d-sm-none d-md-flex"},N=["onClick"],B={class:"dropdown d-sm-block d-md-none"},S=t("button",{class:"btn btn-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Brand Select ",-1),A={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},E=["onClick"],M={class:"container productsList mt-md-7 mt-sm-4 mb-6"},V={class:"row"},T=["onClick"],F=["src"],U={class:"fs-3 fw-bold mb-0"},W={class:"mb-0"},j={class:"d-flex"},q={class:"mb-0 me-2"},H={key:0,class:"mb-0 text-info text-decoration-line-through"},I={class:"d-flex mt-1"},J={key:0,class:"btn-group d-flex",role:"group","aria-label":"Basic example"},K=["onClick"],O=t("i",{class:"bi bi-heart-fill me-1"},null,-1),R=[O],Z=["onClick"],z=t("i",{class:"bi bi-cart2 me-1"},null,-1),G=[z],Q={key:1,class:"spinner-border spinner-border-sm text-primary mt-1 ms-1",role:"status"},X=t("span",{class:"visually-hidden"},"Loading...",-1),Y=[X];function tt(s,a,c,u,i,o){const p=g("LoadingView"),f=g("Page"),P=g("Subscribe");return n(),r(h,null,[_(p,{active:i.isLoading},null,8,["active"]),t("div",C,[t("div",x,[t("div",D,[t("ul",$,[(n(!0),r(h,null,b(i.brand,(e,d)=>(n(),r("li",{key:d},[t("button",{type:"button",class:"btn btn-primary",onClick:y=>o.getProducts(e)},l(e),9,N)]))),128)),t("li",null,[t("button",{type:"button",class:"btn btn-primary",onClick:a[0]||(a[0]=e=>o.getProducts(s.item))},"ALL")])]),t("div",B,[S,t("ul",A,[(n(!0),r(h,null,b(i.brand,(e,d)=>(n(),r("li",{key:d},[t("button",{class:"dropdown-item",type:"button",onClick:y=>o.getProducts(e)},l(e),9,E)]))),128)),t("li",null,[t("button",{type:"button",class:"dropdown-item",onClick:a[1]||(a[1]=e=>o.getProducts(s.item))},"ALL")])])])])])]),t("div",M,[t("div",V,[(n(!0),r(h,null,b(i.nowProducts,e=>(n(),r("div",{class:"col-lg-3 col-sm-6 mb-6",key:e.id},[t("button",{type:"button",class:"w-100 p-0 border-0 mb-1",onClick:d=>o.getProduct(e.id)},[t("img",{src:e.imageUrl,class:"w-100",alt:"product"},null,8,F)],8,T),t("h4",U,l(e.title),1),t("p",W,l(e.category),1),t("div",j,[t("p",q,l(`NT$${s.$filters.currency(e.price)}`),1),e.origin_price>e.price?(n(),r("p",H,l(`NT$${s.$filters.currency(e.origin_price)}`),1)):m("",!0)]),t("div",I,[this.btnLoading?m("",!0):(n(),r("div",J,[t("button",{type:"button",class:"btn text-primary p-0 me-2",onClick:d=>o.addWish(e)},R,8,K),t("button",{type:"button",class:"btn text-primary p-0 ms-1",onClick:d=>o.addCart(e.id)},G,8,Z)])),this.btnLoading?(n(),r("div",Q,Y)):m("",!0)])]))),128))])]),_(f,{pages:i.pageData,onEmitPage:o.nowPage},null,8,["pages","onEmitPage"]),_(P)],64)}const at=v(k,[["render",tt]]);export{at as default};
