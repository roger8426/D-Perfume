import{P as L}from"./PageComponent-5df3d899.js";import{S as v}from"./SubScribe-0cea7c35.js";import{_ as k,m as C,a as x,r as g,o as r,c,d as _,b as t,F as h,f as m,t as l,e as b}from"./index-ba954f0e.js";import{w as f}from"./wishList-0a6d97ad.js";const D={data(){return{products:{},nowProducts:{},id:"",brand:["CHANEL","Jo Malone","Curology","Dior","Chloe","ZARA","TONIK"],isLoading:!1,btnLoading:!1,cartNum:0,pageData:{},tempWishList:[]}},computed:{...C(f,["wishList"])},components:{Subscribe:v,Page:L},methods:{getProducts(e){this.isLoading=!0;const a="https://vue3-course-api.hexschool.io/api/roger8426-api/products/all";this.$http.get(a).then(n=>{if(n.data.success){const i=Math.ceil(n.data.products.length/12);this.pageData={perPage:12,current_page:1,total_pages:i,has_next:i>1},e?(this.products=n.data.products.filter(o=>o.category===e),this.pageData.total_pages=Math.ceil(this.products.length/12)):this.products=n.data.products,this.nowProducts=this.products.filter((o,u)=>{if(u>=0&&u<12)return o})}this.isLoading=!1,window.scrollTo(0,0)})},nowPage(e){this.pageData.current_page=e,this.pageData.has_next=this.pageData.total_pages>this.pageData.current_page,this.pageData.has_pre=this.pageData.current_page>1;const a=e*this.pageData.perPage-this.pageData.perPage+1,n=e*this.pageData.perPage;this.nowProducts=this.products.filter((p,i)=>{const o=i+1;if(o>=a&&o<=n)return p}),window.scrollTo(0,0)},getProduct(e){this.$router.push(`/user/product/${e}`)},addCart(e){const a="https://vue3-course-api.hexschool.io/api/roger8426-api/cart",n={product_id:e,qty:1};this.btnLoading=!0,this.$http.post(a,{data:n}).then(p=>{p.data.success&&this.$http.get(a).then(i=>{this.cartNum=i.data.data.carts.length,this.emitter.emit("cart-num",this.cartNum),this.btnLoading=!1})})},addWish(e){if(this.wishList.find(n=>n.id===e.id)){alert("已在願望清單中");return}else this.tempWishList.push(e),window.localStorage.setItem("wishList",JSON.stringify(this.tempWishList)),this.wishListUpdate()},...x(f,["wishListUpdate"])},created(){this.getProducts()}},$={class:"bg-primary"},N={class:"container px-0"},S={class:"col"},B={class:"d-flex mb-0 ps-0 d-sm-none d-md-flex"},A=["onClick"],M={class:"dropdown d-sm-block d-md-none"},T=t("button",{class:"btn btn-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Brand Select ",-1),V={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},W=["onClick"],E={class:"container productsList mt-md-7 mt-sm-4 mb-6"},U={class:"row"},F=["onClick"],I=["src"],J={class:"fs-3 fw-bold mb-0"},O={class:"mb-0"},q={class:"d-flex"},H={class:"mb-0 me-2"},K={key:0,class:"mb-0 text-info text-decoration-line-through"},R={class:"d-flex mt-1"},Z={key:0,class:"btn-group d-flex",role:"group","aria-label":"Basic example"},j=["onClick"],z=t("i",{class:"bi bi-heart-fill me-1"},null,-1),G=[z],Q=["onClick"],X=t("i",{class:"bi bi-cart2 me-1"},null,-1),Y=[X],tt={key:1,class:"spinner-border spinner-border-sm text-primary mt-1 ms-1",role:"status"},st=t("span",{class:"visually-hidden"},"Loading...",-1),et=[st];function ot(e,a,n,p,i,o){const u=g("LoadingView"),w=g("Page"),P=g("Subscribe");return r(),c(h,null,[_(u,{active:i.isLoading},null,8,["active"]),t("div",$,[t("div",N,[t("div",S,[t("ul",B,[(r(!0),c(h,null,m(i.brand,(s,d)=>(r(),c("li",{key:d},[t("button",{type:"button",class:"btn btn-primary",onClick:y=>o.getProducts(s)},l(s),9,A)]))),128)),t("li",null,[t("button",{type:"button",class:"btn btn-primary",onClick:a[0]||(a[0]=s=>o.getProducts(e.item))},"ALL")])]),t("div",M,[T,t("ul",V,[(r(!0),c(h,null,m(i.brand,(s,d)=>(r(),c("li",{key:d},[t("button",{class:"dropdown-item",type:"button",onClick:y=>o.getProducts(s)},l(s),9,W)]))),128)),t("li",null,[t("button",{type:"button",class:"dropdown-item",onClick:a[1]||(a[1]=s=>o.getProducts(e.item))},"ALL")])])])])])]),t("div",E,[t("div",U,[(r(!0),c(h,null,m(i.nowProducts,s=>(r(),c("div",{class:"col-lg-3 col-sm-6 mb-6",key:s.id},[t("button",{type:"button",class:"w-100 p-0 border-0 mb-1",onClick:d=>o.getProduct(s.id)},[t("img",{src:s.imageUrl,class:"w-100",alt:"product"},null,8,I)],8,F),t("h4",J,l(s.title),1),t("p",O,l(s.category),1),t("div",q,[t("p",H,l(`NT$${e.$filters.currency(s.price)}`),1),s.origin_price>s.price?(r(),c("p",K,l(`NT$${e.$filters.currency(s.origin_price)}`),1)):b("",!0)]),t("div",R,[this.btnLoading?b("",!0):(r(),c("div",Z,[t("button",{type:"button",class:"btn text-primary p-0 me-2",onClick:d=>o.addWish(s)},G,8,j),t("button",{type:"button",class:"btn text-primary p-0 ms-1",onClick:d=>o.addCart(s.id)},Y,8,Q)])),this.btnLoading?(r(),c("div",tt,et)):b("",!0)])]))),128))])]),_(w,{pages:i.pageData,onEmitPage:o.nowPage},null,8,["pages","onEmitPage"]),_(P)],64)}const ct=k(D,[["render",ot]]);export{ct as default};
