import{P as y}from"./PageComponent-19297465.js";import{S as L}from"./SubScribe-1758dee8.js";import{_ as v,r as u,o as n,c,b as g,a as t,F as _,e as m,t as l,d as b}from"./index-db33ef60.js";const w={data(){return{products:{},nowProducts:{},id:"",brand:["CHANEL","Jo Malone","Curology","Dior","Chloe","ZARA","TONIK"],isLoading:!1,btnLoading:!1,cartNum:0,pageData:{},wishList:[]}},inject:["emitter"],components:{Subscribe:L,Page:y},methods:{getProducts(s){this.isLoading=!0;const i="https://vue3-course-api.hexschool.io/api/roger8426-api/products/all";this.$http.get(i).then(r=>{if(r.data.success){const o=Math.ceil(r.data.products.length/12);this.pageData={perPage:12,current_page:1,total_pages:o,has_next:o>1},s?(this.products=r.data.products.filter(a=>a.category===s),this.pageData.total_pages=Math.ceil(this.products.length/12)):this.products=r.data.products,this.nowProducts=this.products.filter((a,h)=>{if(h>=0&&h<12)return a})}this.isLoading=!1})},nowPage(s){this.pageData.current_page=s,this.pageData.has_next=this.pageData.total_pages>this.pageData.current_page,this.pageData.has_pre=this.pageData.current_page>1;const i=s*this.pageData.perPage-this.pageData.perPage+1,r=s*this.pageData.perPage;this.nowProducts=this.products.filter((d,o)=>{const a=o+1;if(a>=i&&a<=r)return d})},getProduct(s){this.$router.push(`/user/product/${s}`)},addCart(s){const i="https://vue3-course-api.hexschool.io/api/roger8426-api/cart",r={product_id:s,qty:1};this.btnLoading=!0,this.$http.post(i,{data:r}).then(d=>{d.data.success&&this.$http.get(i).then(o=>{this.cartNum=o.data.data.carts.length,this.emitter.emit("cart-num",this.cartNum),this.btnLoading=!1})})},addWish(s){this.wishList[0]?this.wishList.forEach(i=>{i.id!==s.id?this.wishList.push(s):alert("已在願望清單中")}):this.wishList.push(s),this.emitter.emit("wishList",this.wishList)}},created(){this.getProducts()}},k={class:"bg-primary"},C={class:"container px-0"},D={class:"col"},x={class:"d-flex mb-0 ps-0"},$=["onClick"],N={class:"container productsList mt-7 mb-6"},E={class:"row"},S=["onClick"],V=["src"],A={class:"fs-3 fw-bold mb-0"},B={class:"mb-0"},M={class:"d-flex"},T={class:"mb-0 me-2"},F={key:0,class:"mb-0 text-info text-decoration-line-through"},U={class:"d-flex mt-1"},W={key:0,class:"btn-group d-flex",role:"group","aria-label":"Basic example"},j=["onClick"],q=t("i",{class:"bi bi-heart-fill me-1"},null,-1),H=[q],I=["onClick"],J=t("i",{class:"bi bi-cart2 me-1"},null,-1),K=[J],O={key:1,class:"spinner-border spinner-border-sm text-primary mt-1 ms-1",role:"status"},R=t("span",{class:"visually-hidden"},"Loading...",-1),Z=[R];function z(s,i,r,d,o,a){const h=u("LoadingView"),f=u("Page"),P=u("Subscribe");return n(),c(_,null,[g(h,{active:o.isLoading},null,8,["active"]),t("div",k,[t("div",C,[t("div",D,[t("ul",x,[(n(!0),c(_,null,m(o.brand,(e,p)=>(n(),c("li",{key:p},[t("button",{type:"button",class:"btn btn-primary",onClick:G=>a.getProducts(e)},l(e),9,$)]))),128)),t("li",null,[t("button",{type:"button",class:"btn btn-primary",onClick:i[0]||(i[0]=e=>a.getProducts(s.item))},"ALL")])])])])]),t("div",N,[t("div",E,[(n(!0),c(_,null,m(o.nowProducts,e=>(n(),c("div",{class:"col-3 mb-6",key:e.id},[t("button",{type:"button",class:"w-100 p-0 border-0 mb-1",onClick:p=>a.getProduct(e.id)},[t("img",{src:e.imageUrl,class:"w-100",alt:"product"},null,8,V)],8,S),t("h4",A,l(e.title),1),t("p",B,l(e.category),1),t("div",M,[t("p",T,l(`NT$${s.$filters.currency(e.price)}`),1),e.origin_price>e.price?(n(),c("p",F,l(`NT$${s.$filters.currency(e.origin_price)}`),1)):b("",!0)]),t("div",U,[this.btnLoading?b("",!0):(n(),c("div",W,[t("button",{type:"button",class:"btn text-primary p-0 me-2",onClick:p=>a.addWish(e)},H,8,j),t("button",{type:"button",class:"btn text-primary p-0 ms-1",onClick:p=>a.addCart(e.id)},K,8,I)])),this.btnLoading?(n(),c("div",O,Z)):b("",!0)])]))),128))])]),g(f,{pages:o.pageData,onEmitPage:a.nowPage},null,8,["pages","onEmitPage"]),g(P)],64)}const tt=v(w,[["render",z]]);export{tt as default};
